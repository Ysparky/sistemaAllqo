@model IEnumerable<sistemaAllqo.Models.Sesion>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="card shadow">
    <div class="card-header">
        <h3 class="m-0 font-weight-bold text-primary float-left">SESIONES</h3>
    </div>
    <div class="card-body">
        <table class="table text-center">
            <thead class="thead-dark">
                <tr>
                    <th class="text-white">
                        @Html.DisplayNameFor(model => model.fechaSesion)
                    </th>
                    <th class="text-white">
                        @Html.DisplayNameFor(model => model.lugar)
                    </th>
                    <th class="text-white">
                        @Html.DisplayNameFor(model => model.idTipo)
                    </th>
                    <th class="text-white">
                        @Html.DisplayNameFor(model => model.numMascotas)
                    </th>
                    <th class="text-white">
                        @Html.DisplayNameFor(model => model.servicio)
                    </th>
                    <th class="text-white">
                        @Html.DisplayNameFor(model => model.estado)
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @{ int i = 0;}
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            @{
                                DateTime fecha = item.fechaSesion;
                                if (item.estado == "Creado") { ViewData["Estado"] = "bg-info"; } else { ViewData["Estado"] = "bg-success"; }
                            }
                            @fecha.ToString("dddd dd MMMM yyyy, hh:mm tt")
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.lugar)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.tipoPerro.nombre)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.numMascotas)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.servicio.categoria)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.estado)
                        </td>
                        <td>
                            <button type="button" class="btn btn-light btn-sm" data-toggle="collapse" data-target="#demo1_@i"><i class="fas fa-eye"></i></button>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="12" class="hiddenRow">
                            <div class="accordion-body collapse" id="demo1_@i">
                                <table class="table ">
                                    <thead>
                                        <tr>
                                            <th>Mascota</th>
                                            <th>Cliente</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var items in ViewData["listSXM"] as IEnumerable<SesionxMascota>)
                                        {
                                            if (items.idSesion == item.idSesion)
                                            {
                                                string nombreCompleto = items.mascota.cliente.apellidos + " " + items.mascota.cliente.nombres;
                                                <tr>
                                                    <td>@items.mascota.nombre</td>
                                                    <td>@nombreCompleto </td>
                                                </tr>
                                            }

                                        }
                                    </tbody>
                                </table>
                            </div>
                        </td>
                    </tr>
                    i++;
                }
            </tbody>
        </table>

    </div>
    <div class="card-footer"></div>
</div>
